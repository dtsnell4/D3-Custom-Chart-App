<!DOCTYPE html>
<html lang="en">
<head>
    <title>D3</title>

    <meta charset="utf-8">

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Amiko" rel="stylesheet">
    <link rel="stylesheet" href="bar.css">
    <script src="bar.js"></script>

</head>
<body>
    <header>
        <span class="brand">WYSIWYG Bar Chart</span>
        <nav>
            <a id="works">How It Works</a>
            <span class="divider"></span>
            <a id="editor">Edit Chart</a>
        </nav>
    </header>
    <div class="container-fluid">
        <div  class="panel main">
            <div id="chart-container">
                <div id="inner">
                    <svg id="chart"></svg>
                </div>
            </div>
            <div>
                <button type="button" id="update" class="btn btn-med btn-info"><span class="uptext">Update </span><span class="glyphicon glyphicon-refresh"></span></button>
            </div>
        </div>
        <div id="panel2" class="panel main">
            <h2>D3 Charts Without Knowing D3.js</h2>
            <p>
                Need a robust D3 chart for your site, but don't have the time or desire to learn D3.js?  This is a simple app that lets you design your own chart in the browser, then gives you the code to paste into your web page.  And the beauty of the chart being entirely in D3 is that you have the option of updating or expanding it later using D3.js if you wish. 
            </p>
            <h4>Why D3.js?</h4>
            <p>
                The main reason is that D3.js the most powerful data visualization language out there, and it works on the web, right in the browser.  It has become the de facto standard for data visualization.  One hundred percent JavaScript, D3 works with existing web technologies of the client side stack - HTML, CSS, JavaScript and SVG.  Nothing server side required, no additional frameworks or plugins.
            </p>
            <h4>Getting Started</h4>
            <p>
                The first thing you need is data.  If you look at the editor the first field already contains some very simple data, the frequency of letters appearing in the English language.  You can use the default data, but keep in mind that different styles can look different with varying data.  For example, on the default x-axis the tick labels are single letters.  They fit just fine horizontally.  But imagine if those labels were long words.  They would overlap each other which would be aesthetically unpleasing.  In that case you would want to rotate the x-axis labels, 45 or 90 degrees, depending on which looks best in your case. 
            </p>
            <p>
                If possible, you should use a sample of your data for the best results. You can paste your data into this field if you have it, but it must be in tab separated format (.TSV).  Just make sure it is properly formatted TSV, and there are no blanks lines, including the last line.  
                <blockquote>This is not a requirement when you have the final code on your website.  You can read the data from a TSV, CSV or JSON file, or use any SOAP or REST web service you want to provide the chart JSON data to use.  Again, existing web technologies. :-)</blockquote>
            </p>
            <p>
                After you have the data formatted in the text field, scroll down the page and begin editing the various features of the chart.  Click the red <span class="glyphicon glyphicon-question-sign howto" data-toggle="collapse" data-target="#paddinginfo"></span> icon for more information about each section. </p>
            <p>
                D3 charts utilize SVG's.  If you are already familiar with SVG, you will know that styling can be very different than HTML, and regular CSS does not always apply.  The features listed in the editor are ones that cannot realistically (at least easily) be styled with CSS.  Other features, such as the text attributes, color of the bars and features of the axes can be styled with normal CSS.  
                <blockquote>The most important thing to remember about styling is that colors of SVG elements do not use the 'color' attribute, but 'fill' instead. </blockquote>
            </p>
            <p>
                Go through the fields and change the attributes to get the look you want.  Just click the "Update" button to see the changes on the chart to the left.  
            </p>
            <h4>The Fun Part</h4>
            <p>
                Once you have the chart looking the way you want it, its time to get your customized code.  Scroll down to the end of the editor, and click the "Get the Code" button.  The code will be displayed in the text field.  This code is a complete HTML document.  Just copy and paste the code into a file in your editor, and save it as HTML.  
            </p>
            <p>
                By default, the code looks for a "data.tsv" file in the same directory.  Create this file with the tab separated data in it (copy it from the editor if you done have real data yet).  Open the HTML file in your browser and boom - there is your chart.  <blockquote>In the comments are instructions for changing the code to use a CSV or JSON file.  It also contains instruction about how to use external JSON data to create and update the chart.</blockquote>
            </p>
            <p>
                The code can be broken up and put into your own pages, and it is well documented to explain how to do that.  Just put the CSS in your style sheet, the 3 line block of HTML in your web page, and the JavaScript in your .js document. <blockquote>The HTML has a "chart-container" div that contains the SVG chart. This element <em>must</em> have a set width and height.  The SVG chart will automatically size itself to fill the container.  Without a set size, the chart will not display correctly.</blockquote>
            </p>
        </div>
        <div id="panel" class="panel main">
            <form class="form-horizontal">
                <h3>TSV Data <span class="glyphicon glyphicon-question-sign" data-toggle="collapse" data-target="#tsvinfo"></span></h3>
                <div id="tsvinfo" class="panel panel-default collapse">
					<div class="panel-body">
						Paste your data into the text field below so you can see what it will look like in the chart.
					Requirements:
						<ol>
							<li>The data must be Tab Separated Value format (TSV). You do not need to use TSV once you have the code on your site, this is just for this editor.</li>
							<li>Make sure there are no blank lines, including the LAST LINE.  The data should not end in an empty line, it may cause problems.</li>
							<li>The FIRST line must be the data labels (column headers) for each axis. You can rename the axis labels below, but they must be present in the TSV.</li>
						</ol>
					</div>
				</div>
                <div class="form-group">
                    <div class="col-sm-12">
                        <textarea id="tsvdata" class="form-control"></textarea>
                    </div>
                </div>
                <hr>
            	<h3>Chart Padding <span class="glyphicon glyphicon-question-sign" data-toggle="collapse" data-target="#paddinginfo"></span></h3>
                <div id="paddinginfo" class="panel panel-default collapse">
					<div class="panel-body">
						Adjust the chart's padding with the following fields. For example, this may become necessary if you adjust the the axis label font, or if the tick labels are wider/taller.   
					</div>
				</div>
            	<div class="form-group row">
                	<label class="control-label col-xs-3">
                        Left
                    </label>
                    <div class="col-xs-3">
                        <input type="text" class="form-control" id="left-margin" value="45">
                    </div>
                    <label class="control-label col-xs-3">
                        Bottom
                    </label>
                    <div class="col-xs-3">
                        <input type="text" class="form-control" id="bottom-margin" value="35">
                    </div>
                </div>
                <div class="form-group row">
					<label class="control-label col-xs-3">
                        Top
                    </label>
                    <div class="col-xs-3">
                        <input type="text" class="form-control" id="top-margin" value="20">
                    </div>
                    <label class="control-label col-xs-3">
                        Right
                    </label>
                    <div class="col-xs-3">
                        <input type="text" class="form-control" id="right-margin" value="20">
                    </div>
                </div>
                <hr>

                <h3>Axes <span class="glyphicon glyphicon-question-sign" data-toggle="collapse" data-target="#axesinfo"></span></h3>
                <div id="axesinfo" class="panel panel-default collapse">
					<div class="panel-body">
						<p>You can change the axis labels in the fields below, as well as rotate the axis labels if they are too wide and overlap.</p>
						<p>Also, you can adjust the number of tick labels displayed.  This only applies to axis data that is <a href="https://en.wikipedia.org/wiki/Linear_scale" target="_blank">linear</a>, logarithmic, sequential time based, etc.  It is not applied to <a href="https://en.wikipedia.org/wiki/Level_of_measurement#Ordinal_scale" target="_blank">ordinal</a> data (i.e. text strings such as letters, months, people's names, countries, etc.)   Note: D3.js will not use any number, but will round to the nearest acceptable integer that fits the scale of the axis.</p>
						<p>You can also change the number format for the y axis tick labels to match the data, using the radio buttons below. </p> 
                        <p>Styling the text in the axes can be done via CSS.  For example:</p> 
                        <pre>.x-axis-label, .y-axis-label {
    fill: #0004ff;
    font-weight: bold;
    font-size:15px;
}

.axis.axis--x .tick text {
    font-size: 10px;
    fill: #111;
}</pre> 
					</div>
				</div>
                <div class="form-group">
                    <div class="col-sm-12">
	                	<h4>X Axis Label</h4>
                        <input type="text" class="form-control" id="xlabel" onkeydown="if (event.keyCode == 13) { return false;}">
	                	<h4>Y Axis Label</h4>
                        <input type="text" class="form-control" id="ylabel" onkeydown="if (event.keyCode == 13) { return false;}">
                        <h4>Axis Tick Label Rotation</h4>
                        <div class="form-group row control-top-pad">
                    		<label class="control-label col-xs-3">X Axis</label>
	                    	<div class="col-xs-3 control-div">
	                    		<select id="xrotation">
		                        	<option value="0">0</option>
		                        	<option value="45">45</option>
		                        	<option value="90">90</option>
		                        </select> 
	                        </div> 
	                        <label class="control-label col-xs-3">Y Axis</label>
	                    	<div class="col-xs-3 control-div">
	                    		<select id="yrotation">
		                        	<option value="0">0</option>
		                        	<option value="-45">45</option>
		                        	<option value="-90">90</option>
		                        </select> 
	                        </div> 
						</div>
                        <h4>Number of Tick Labels</h4>
                        <div class="form-group row">
                    		<label class="control-label col-xs-3">X Axis</label>
	                    	<div class="col-xs-3 control-div">
	                    		<input type="number" class="form-control" id="xticknum" onkeydown="if (event.keyCode == 13) { return false;}" value="10">
                    		</div>
                    		<label class="control-label col-xs-3">Y Axis</label>
	                    	<div class="col-xs-3 control-div">
	                        	<input type="number" class="form-control" id="yticknum" onkeydown="if (event.keyCode == 13) { return false;}" value="10">
	                        </div>
                        </div>
                        <h4>Y Axis Number Format</h4>
		                <div class="col-sm-12">
		                	<form action="">
                                <ul class="formatlist">
                                    <li>
                                        <input type="radio" name="tickformat" value="%" checked> Percentage
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="d"> Decimal notation, rounded to integer

                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="f"> Fixed point notation
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="g"> <span>Decimal or exponent notation, rounded to significant digits</span>
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value=""> Decimal or exponent notation, rounded to significant digits but trim insignificant trailing zeros
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="r"> Decimal notation, rounded to significant digits
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="s"> Decimal notation with an <a href="https://en.wikipedia.org/wiki/Metric_prefix#List_of_SI_prefixes" target="_blank">SI prefix</a>, rounded to significant digits
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="e"> Exponent notation
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="b"> Binary notation, rounded to integer
                                    </li>
                                    <li>
                                         <input type="radio" name="tickformat" value="o"> Octal notation, rounded to integer
                                    </li>
                                    <li>
                                         <input type="radio" name="tickformat" value="x"> Hexadecimal notation, using lower-case letters, rounded to integer
                                    </li>
                                    <li>
                                        <input type="radio" name="tickformat" value="X"> Hexadecimal notation, using upper-case letters, rounded to integer
                                    </li>
                                </ul>
							</form>
		                </div>
                    </div>
                </div>
                <hr>

                <h3>Bars <span class="glyphicon glyphicon-question-sign" data-toggle="collapse" data-target="#barsinfo"></span></h3>
                <div id="barsinfo" class="panel panel-default collapse">
                    <div class="panel-body">
                        <p>Change the color of the bars with the color fields below.  This can be done in the CSS, but rememeber to use the "fill" attribute, not "color". For example:
<pre>.bar {
    fill: #343533;
}
.bar:hover {
    fill: #ff0000;
}</pre>
                        </p>  
                        <p>To adjust the bars width, set the padding of the bars as a percentage of total width in the field below.  Higher percentage produces thinner bars. Bar width cannot be set via CSS.</p>
                    </div>
                </div>   
                <div class="form-group row">
                    <label class="control-label col-xs-3">
                        Bar Color
                    </label>
                    <div class="col-xs-3">
                        <input type="color" class="form-control" id="bar-color" value="#337ab7">
                    </div>
                    <label class="control-label col-xs-3">
                        Bar Hover Color
                    </label>
                    <div class="col-xs-3">
                        <input type="color" class="form-control" id="bar-hover-color" value="#a52a2a">
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-xs-6">
                        <label class="control-label col-xs-6">
                            Bar Padding
                        </label>
                        <div class="col-xs-6">
                            <select id="bar_padding" class="form-control">
                                <option>10%</option>
                                <option>20%</option>
                                <option>30%</option>
                                <option>40%</option>
                                <option>50%</option>
                                <option>60%</option>
                                <option>70%</option>
                                <option>80%</option>
                                <option>90%</option>
                            </select>
                        </div>
                    </div>
                </div> 
                <hr>

                <h3>Tooltip <span class="glyphicon glyphicon-question-sign" data-toggle="collapse" data-target="#tooltipinfo"></span></h3>
                <div id="tooltipinfo" class="panel panel-default collapse">
                    <div class="panel-body">
                        <p>Show or hide a hover tooltip that displays the data for each bar.</p>
                        <p>Also, set the significant digits displayed in the hover tooltip for each bar.</p> 
                        <p>Custom styling of the tooltip itself may be done via CSS. For example:</p>
                        <pre>.toolTip {
    background-color: #ffffff;
    border: 1px solid #ccc;
    padding: 5px;
    text-align: center;
}</pre> 
                    </div>
                </div>
	            <div class="row control-top-pad">
                    <label class="control-label col-xs-4">
                        Show Tooltip
                    </label>
                    <div class="col-xs-1 control-div">
                        <input type="checkbox" name="showtooltip" style="margin-top: 0px" checked>
                    </div>
	            	<label class="control-label col-xs-5">
                        Significant Digits
                    </label>
                    <div class="col-xs-2">
                        <input type="number" class="form-control" id="sig_digits" value="1">
                    </div>
                </div>   
                <hr>

                <h3>Get The Code <button type="button" id="getcode" class="btn btn-sm btn-info"><span class="glyphicon glyphicon-arrow-right"></span></button></h3>
                <div class="form-group">
                    <div class="col-sm-12">
                        <textarea id="thecode" class="form-control"></textarea>
                    </div>
                </div>
            </form>
        </div>
    </div>
    

</body>
</html>
